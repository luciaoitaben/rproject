
> library(abind, pos=16)

> library(e1071, pos=17)

> numSummary(Pec1[,"price", drop=FALSE], groups=Pec1$beds_text, statistics=c("mean", "sd", "IQR", "quantiles", "cv"),
+    quantiles=c(0,.25,.5,.75,1))
         mean         sd    IQR          cv  0%    25%    50%     75% 100% price:n
10B 445.53333 333.831245 319.00 0.749284554  15 250.00  360.0  569.00 1442      45
11B 502.80000 109.016971 140.00 0.216819752 347 460.00  495.0  600.00  612       5
12B 457.60000 370.230585 567.00 0.809070333  19 124.00  401.0  691.00 1157      15
13B 788.33333 315.274906 537.75 0.399925886 450 541.75  721.0 1079.50 1157       6
14B 314.66667 139.095291  86.00 0.442040120  41 280.00  366.0  366.00  549       9
15B 696.18182 502.892000 393.00 0.722357273 175 357.00  664.0  750.00 1825      11
16B 435.60000 612.554732 311.00 1.406232168  17  35.00  280.0  346.00 1500       5
18B 782.40000 339.171491 315.00 0.433501394 425 604.00  664.0  919.00 1300       5
19B 613.00000   1.414214   1.00 0.002307037 612 612.50  613.0  613.50  614       2
1B   87.49642 258.450173  55.00 2.953836952   9  36.00   55.0   91.00 9200    4895
20B 962.00000  65.817931  57.00 0.068417807 886 943.00 1000.0 1000.00 1000       3
26B  41.00000         NA   0.00          NA  41  41.00   41.0   41.00   41       1
2B  139.39662 170.475480 111.00 1.222952759  10  69.00  117.0  180.00 5000    2544
3B  175.69576 144.491672 109.00 0.822397048  10 110.00  159.0  219.00 5000    2074
4B  214.75716 357.571091 123.00 1.665001935  13 127.00  183.0  250.00 9999    1466
5B  259.12567 387.960797 150.00 1.497191688  10 149.00  219.0  299.00 6000     748
6B  329.09719 559.399737 160.00 1.699801003  10 177.00  240.0  337.00 5000     463
7B  324.24000 168.239702 179.50 0.518873988  50 229.00  285.0  408.50  950     175
8B  490.64894 715.722580 247.25 1.458726447  13 250.50  330.5  497.75 5000      94
9B  491.25641 294.400883 303.50 0.599281509 100 290.00  414.0  593.50 1413      39

> Pregunta2 <- subset(Pec1, subset=price <=500)

> Pregunta2 <- within(Pregunta2, {
+   gender <- factor(gender, labels=c('Hombre','Mujer'))
+ })

> with(Pregunta2, Hist(beds, scale="frequency", breaks="Sturges", col="darkgray"))

> with(Pregunta2, Hist(beds, scale="frequency", breaks="Sturges", col="darkgray"))

> with(Pregunta2, Hist(price, scale="frequency", breaks="Sturges", col="darkgray"))

> with(Pregunta2, Dotplot(beds, bin=FALSE))

> indexplot(Pregunta2[,'beds', drop=FALSE], type='h', id.method='y', id.n=2)
 1365 10200 
 1351  9996 

> library(aplpack, pos=18)

> with(Pregunta2, stem.leaf(beds, na.rm=TRUE))
1 | 2: represents 1.2
 leaf unit: 0.1
            n: 12372
   4874    1* | 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
            t | 
            f | 
            s | 
           1. | 
  (2536)   2* | 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
            t | 
            f | 
            s | 
           2. | 
   4962    3* | 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
            t | 
            f | 
            s | 
           3. | 
   2903    4* | 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
            t | 
            f | 
            s | 
           4. | 
   1457    5* | 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
            t | 
            f | 
            s | 
           5. | 
    733    6* | 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
HI: 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 11 11 11 12 12 12 12 12 12 12 12 12 13 14 14 14 14 14 14 14 14 15 15 15 15 15 16 16 16 16 18 26

> Boxplot( ~ beds, data=Pregunta2, id=list(method="y"))
 [1] "10200" "1365"  "580"   "1643"  "5456"  "10052" "317"   "581"   "662"   "665"  

> with(Pregunta2, qqPlot(beds, dist="norm", id=list(method="y", n=2, labels=rownames(Pregunta2))))
10200  1365 
 9996  1351 

> with(Pregunta2, Barplot(beds_text, xlab="beds_text", ylab="Frequency", label.bars=TRUE))

> library(colorspace, pos=19)

> with(Pregunta2, piechart(gender, xlab="", ylab="", main="gender", col=rainbow_hcl(2), scale="percent"))

> Pregunta2 <- subset(Pregunta2, subset=beds < 7)

> AnovaModel.1 <- lm(price ~ beds_text, data=Pregunta2, contrasts=list(beds_text ="contr.Sum"))

> Anova(AnovaModel.1)
Anova Table (Type II tests)

Response: price
            Sum Sq    Df F value    Pr(>F)    
beds_text 32883934     5  1020.1 < 2.2e-16 ***
Residuals 77741547 12058                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

> Tapply(price ~ beds_text, mean, na.action=na.omit, data=Pregunta2) # means
      10B       11B       12B       13B       14B       15B       16B       18B       19B        1B       20B 
       NA        NA        NA        NA        NA        NA        NA        NA        NA  77.13993        NA 
      26B        2B        3B        4B        5B        6B        7B        8B        9B 
       NA 132.80560 169.35551 192.38520 219.58702 235.08706        NA        NA        NA 

> Tapply(price ~ beds_text, sd, na.action=na.omit, data=Pregunta2) # std. deviations
      10B       11B       12B       13B       14B       15B       16B       18B       19B        1B       20B 
       NA        NA        NA        NA        NA        NA        NA        NA        NA  65.57987        NA 
      26B        2B        3B        4B        5B        6B        7B        8B        9B 
       NA  83.25614  84.49536  92.88509 100.36234 106.06739        NA        NA        NA 

> xtabs(~ beds_text, data=Pregunta2) # counts
beds_text
 10B  11B  12B  13B  14B  15B  16B  18B  19B   1B  20B  26B   2B   3B   4B   5B   6B   7B   8B   9B 
   0    0    0    0    0    0    0    0    0 4874    0    0 2536 2059 1446  724  425    0    0    0 

